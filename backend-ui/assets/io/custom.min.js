var haveChangeData=!0;function admin_link(t){return void 0===typeof t&&(t=""),t="/"+t.replace("//","/"),window.location.origin+t}function vpdt_link(t){return void 0===typeof t&&(t=""),"https://vpvietrantour.local"+(t="/"+t.replace("//","/"))}function __callback(t){switch(t.status){case"notif-error":$.toast({heading:"Thông báo lỗi",position:"top-right",text:t.msg,icon:"error",loader:!0,loaderBg:"#9EC600"});break;case"notif-info":$.toast({heading:"Thông báo",position:"top-right",text:t.msg,icon:"info",loader:!0,loaderBg:"#9EC600"});break;case"notif-success":$.toast({heading:"Thông báo",position:"top-right",text:t.msg,icon:"info",loader:!0,loaderBg:"#4CAF50"});break;case 1:if(alert(t.msg),void 0!==t.data.reload&&!0===t.data.reload)if(getUrlParameters(window.location.href,"slink")){let t=removeParam("slink",window.location.href);window.location.href=t}else location.reload();else void 0!==t.data.redirect&&t.data.redirect&&(window.location.href=t.data.redirect);break;default:alert(t.msg)}}function _GET_URL(url,options={}){return jQuery.ajax({url:url,type:"GET",dataType:options.dataType||"json",success:function(res){return void 0!==options.callback?eval(options.callback(res)):eval(__callback(res))},error:function(t,e,n){alert(n)}}),!1}function _POST_FORM(formId,url,options={}){let{callback:callback,type:type="json",globalCallback:globalCallback=!0}=options,data=[];void 0!==formId&&(data=$(formId).serializeArray());let _token=jQuery("meta[name=_token]").attr("content");if(_token){let t={name:"_token",value:_token};data.push(t),$.ajaxSetup({headers:{"X-CSRF-TOKEN":_token}})}return $.ajax({url:url,type:"POST",data:data,dataType:type,cache:!1,success:function(res){try{eval(options.callback(res))}catch(t){}if(globalCallback)return eval(__callback(res))},error:function(t,e,n){alert(n)}}),!1}function _AUTO_COMPLETE_INIT(selector,link_api,text,multi,options){void 0===multi&&(multi=!0);let selected=$(selector).attr("data-selected"),disabled=$(selector).attr("disabled"),opt={placeholder:text,multiple:multi,disabled:disabled,ajax:{url:link_api,dataType:"json",data:function(t,e){return{q:t}},results:function(t,e){return{results:t.data}}}};"object"==typeof options&&options.data&&(opt.data=options.data);let a=$(selector).select2(opt);try{a.select2("data",eval(selected)),console.log(selected)}catch(t){console.warn(t)}}function _AUTO_COMPLETE_INIT_FILTER(selector,link_api,text,multi,options){void 0===multi&&(multi=!0);let selected=$(selector).attr("data-selected"),opt={placeholder:text,multiple:multi,ajax:{url:link_api,dataType:"json",data:function(t,e){return{q:t}},results:function(t,e){return{results:t.data}}},initSelection:function(t,e){var n=$(t).val();""!==n&&$.ajax(link_api,{data:{q:n},dataType:"json"}).done(function(t){e(t.data)})}};"object"==typeof options&&options.data&&(opt.data=options.data);let a=$(selector).select2(opt);try{a.select2("data",eval(selected)),console.log(selected)}catch(t){console.warn(t)}}function _AUTO_COMPLETE_INIT_FILTER_SELECT_V4(t,e,n,a,o){void 0===a&&(a=!0);$(t).attr("data-selected");let l={placeholder:n,multiple:a,ajax:{url:e,dataType:"json",data:function(t,e){return{q:t}},results:function(t,e){return{results:t.data}}}};"object"==typeof o&&o.data&&(l.data=o.data);$(t).select2(l)}function public_link(t){return location.origin+"/"+t}jQuery(document).ready(function(){try{jQuery(".date-datepicker").flatpickr({enableTime:!0,dateFormat:"d/m/Y"})}catch(t){}try{jQuery(".datetime-datepicker").flatpickr({enableTime:!0,dateFormat:"d/m/Y H:i"})}catch(t){}try{jQuery("form .form-control").change(function(t){haveChangeData=!0})}catch(t){}try{INIT_SELECT2()}catch(t){}try{INIT_SELECT2_WITH_TITLE()}catch(t){}try{initUploadNotes()}catch(t){}try{for(let t in lsFormUpload)initUploadInputForm(lsFormUpload[t])}catch(t){}try{loadNotification()}catch(t){}try{jQuery(".range-datepicker").flatpickr({mode:"range",dateFormat:"d/m/Y",allowInput:!1,locale:{rangeSeparator:"-"},onChange:function(t,e){},onClose:function(t,e,n){this.setDate(e)}})}catch(t){}});var APPLICATION={getListCity(t){_POST(public_link("public-api/location/get-all-city"),[],t)},getLocationSub(t,e){_POST(public_link("public-api/location/get-sub-location?parent_key="+t),[],e)},getPositionByDep(t,e){_POST(public_link("public-api/staff/get-position-list?department_id="+t),[],e)},_changeCity:(t,e,n,a)=>(jQuery(e).attr("readonly",!0),"#location-district"==e&&jQuery("#location-town").html('<option value="">Chọn xã phường</option>').select2(),APPLICATION.getLocationSub(t,function(t){let a='<option value="">'+n+"</option>";if(void 0!==t.data)for(let e in t.data){let n=t.data[e],o="";void 0!==n.name&&(a+='<option value="'+n.slug+'" '+o+">"+n.name+"</option>")}jQuery(e).attr("readonly",!1).html(a).select2()})),_changeDepartment:(t,e,n,a)=>(jQuery(e).attr("readonly",!0),APPLICATION.getPositionByDep(t,function(t){let o='<option value="">'+n+"</option>";if(void 0!==t.data)for(let e in t.data){let n=t.data[e],l="";a&&a==n._id&&(l=" selected"),void 0!==n.name&&(o+='<option value="'+n._id+'" '+l+">"+n.name+"</option>"),console.log(n)}jQuery(e).attr("readonly",!1).html(o).select2()}))};function number_format(t){t=t.toString().replace(/^0+/,"").replace(/\./g,"").replace(/,/g,"");var e="",n="";if(0==(t=""+parseInt(t))||null==t||"0"==t||""==t||isNaN(t))return"";for(var a=0,o=t.length-1;o>=0;o--){var l=t.charAt(o);3!=a?(e+=l,a++):(e+=".",e+=l,a=1)}for(o=e.length-1;o>=0;o--){n+=l=e.charAt(o)}return n}function INIT_SELECT2_WITH_TITLE(){$('[data-toggle="select2-with-title"]').select2({templateResult:function(t){return console.log(t),t.id?$('<div class="select2-title"><div class="s1">'+t.text+"</div><i>"+t.title+"</i></div>"):t.text}})}function INIT_SELECT2(){$('[data-toggle="select2"]').select2()}function INIT_SELECT2_CREATE(){$('[data-toggle="select2-create"]').select2({tags:!0})}function _SHOW_FORM_REMOTE(t,e,n){void 0!==e&&""!=e||(e="myModal"),null!=n?e+=t.replace(/[^\w\s]/gi,""):jQuery(".modal-backdrop").remove(),jQuery("#"+e).remove(),jQuery("body").append('<div class="modal fade" id="'+e+'" tabindex="-1" role="dialog" aria-labelledby="'+e+'Label" aria-hidden="true"><div class="mmbd container-fluid"></div></div>');var a=jQuery("#"+e),o=jQuery("#"+e+" .mmbd");return a.on("show.bs.modal",function(){jQuery(document).off("focusin.modal"),o.load(t)}).modal({backdrop:"static"}),!1}var HAVE_PUSH_SLINK=!1;function _SHOW_FORM_REMOTE_HAVE_LINK(t,e,n){_SHOW_FORM_REMOTE(t,e,n);let a=window.location.href,o=getUrlParameters(a,"slink");return console.log(a),o?a=replaceUrlParam(a,"slink",btoa(t)):-1===a.indexOf("?")?a+="?slink="+btoa(t):a+="&slink="+btoa(t),console.log(a),history.pushState(null,null,a),HAVE_PUSH_SLINK=t,!1}function _CLOSE_MODAL(){if($("#myModal").remove(),$("body").css({paddingRight:0}),$(".modal-backdrop").remove(),$(".modal-open").removeClass("modal-open"),!1!==HAVE_PUSH_SLINK)window.history.back();else if(getUrlParameters(window.location.href,"slink")){let t=removeURLParameter(window.location.href,"slink");window.location.href=t}}function removeParam(t,e){var n=e.split("?")[0],a=[],o=-1!==e.indexOf("?")?e.split("?")[1]:"";if(""!==o){for(var l=(a=o.split("&")).length-1;l>=0;l-=1)a[l].split("=")[0]===t&&a.splice(l,1);n=n+"?"+a.join("&")}return n}function removeURLParameter(t,e){var n=t.split("?");if(n.length>=2){for(var a=encodeURIComponent(e)+"=",o=n[1].split(/[&;]/g),l=o.length;l-- >0;)-1!==o[l].lastIndexOf(a,0)&&o.splice(l,1);return n[0]+(o.length>0?"?"+o.join("&"):"")}return t}function replaceUrlParam(t,e,n){null==n&&(n="");var a=new RegExp("\\b("+e+"=).*?(&|#|$)");if(t.search(a)>=0)return t.replace(a,"$1"+n+"$2");let o=(t=t.replace(/[?#]$/,""))+(t.indexOf("?")>0?"&":"?")+e+"="+n;return console.log(o),o}function getUrlParameters(t,e){return new URL(t).searchParams.get(e)}function _REMOVE_ITEM(t){Swal.fire({title:"Bạn có chắc chắn muốn xóa bản ghi này?",text:"Lưu ý: dữ liệu bị xóa sẽ không thể phục hồi lại được!",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonClass:"btn btn-success mt-2 btn-sm",cancelButtonClass:"btn btn-danger ml-2 mt-2 btn-sm",buttonsStyling:!1,confirmButtonText:"Vâng, Tôi muốn xóa!"}).then(function(e){if(e.value)return _GET_URL(t)})}function _REVERT_ITEM(t){Swal.fire({title:"Bản ghi này đã bị xóa!",text:"Bạn có chắc chắn muốn khôi phục lại bản ghi này?",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonClass:"btn btn-success mt-2 btn-sm",cancelButtonClass:"btn btn-danger ml-2 mt-2 btn-sm",buttonsStyling:!1,confirmButtonText:"Vâng, Khôi phục lại!"}).then(function(e){if(e.value)return _GET_URL(t)})}function _SUBMIT_FORM(t,e){if(haveChangeData)return _POST_FORM(t,e);$.toast({heading:"Thông báo",position:"top-right",text:"Không có dữ liệu nào được thay đổi. Bạn cần thay đổi thông tin trước khi cập nhật",icon:"info",loader:!0,loaderBg:"#9EC600"})}function _UPLOAD_INIT(t="pickfiles",e="#documentFileRegion",n,a){n=n||function(){},a=a||function(){};var o=new plupload.Uploader({runtimes:"html5,flash,silverlight,html4",browse_button:t,url:"/media/do-upload",filters:{max_file_size:"30mb",mime_types:[{title:"Chọn file bất kỳ",extensions:"*"}]},multipart_params:{_token:jQuery("meta[name=_token]").attr("content")},init:{FilesAdded:function(t,a){var l=$("#uploadFileItemClone").clone();for(var i in a){var r=a[i];try{l.find(".js-document-container").attr("id",r.id),l.find(".js-document-loading").show(),$(e).append(l.html())}catch(t){}try{n(r)}catch(t){}}o.start()},FileUploaded:function(t,e,n){haveChangeData=!0,o.removeFile(e),n=JSON.parse(n.response);let l=$("#"+e.id);try{l.find(".js-document-loading").hide(),l.find(".js-document-file").val(n.data.relative_link),l.find(".js-document-link").attr("href",n.data.full_size_link),l.find(".js-document-del").on("click",function(){Swal.fire({title:"Bạn có chắc chắn muốn xóa file này?",text:"Lưu ý: dữ liệu bị xóa sẽ không thể phục hồi lại được!",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonClass:"btn btn-success mt-2 btn-sm",cancelButtonClass:"btn btn-danger ml-2 mt-2 btn-sm",buttonsStyling:!1,confirmButtonText:"Vâng, Tôi muốn xóa!"}).then(function(t){t.value&&($("#"+e.id).remove(),haveChangeData=!0)})})}catch(t){}try{console.log(a),a(n,e)}catch(t){}}}});o.init(),o.bind("FilesAdded",function(t,e){})}function _SAVE_HISTORY(t={name:"",id:"",link:"",popup:"",object_name:""}){if(console.log(t),t.id.length<10)return!1;let e=localStorage.getItem("lsHistory");try{if(e=JSON.parse(e)){for(let n in e){if(e[n].id===t.id){e.splice(n,1);break}}try{e.length>30&&e.pop()}catch(t){}}else e=[];e.unshift(t),localStorage.setItem("lsHistory",JSON.stringify(e))}catch(t){console.log("history",t)}}function approveReport(t,e){if($(e).hasClass("ok-done"))return alert("Bạn đã duyệt báo cáo này rồi!"),!1;Swal.fire({title:"Phê duyệt báo cáo",text:"Bạn có chắc chắn muốn phê duyệt báo cáo này?",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonClass:"btn btn-success mt-2 btn-sm",cancelButtonClass:"btn btn-danger ml-2 mt-2 btn-sm",buttonsStyling:!1,confirmButtonText:"Vâng, Tôi muốn phê duyệt!"}).then(function(n){if(n.value)return _GET_URL(t,{callback:function(t){"notif-success"==t.status&&$(e).html("Đã duyệt").removeClass("btn-secondary").addClass("btn-success").addClass("ok-done"),alert(t.msg)}})})}var show_fancy_box=()=>($.fancybox.open($('[data-fancybox="images"]'),{margin:[44,0,22,0],thumbs:{autoStart:!0,axis:"x"}}),!1);if($('[data-fancybox="images"]').length>0)var main_fancy=$('[data-fancybox="images"]').fancybox({margin:[44,0,22,0],thumbs:{autoStart:!0,axis:"x"}});function Export2Doc(t,e=""){var n="<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'><head><meta charset='utf-8'><title>Export HTML To Doc</title></head><body>"+document.getElementById(t).innerHTML+"</body></html>",a=new Blob(["\ufeff",n],{type:"application/msword"}),o="data:application/vnd.ms-word;charset=utf-8,"+encodeURIComponent(n);e=e?e+".doc":"document.doc";var l=document.createElement("a");document.body.appendChild(l),navigator.msSaveOrOpenBlob?navigator.msSaveOrOpenBlob(a,e):(l.href=o,l.download=e,l.click()),document.body.removeChild(l)}function INPUT_NUMBER(){$(".input-type-number").on("input",function(){event.target.value=event.target.value.replace(/\D/g,"")})}function updateTimer(t,e){var n=new Date(t).getTime(),a=setInterval(function(){var t=(new Date).getTime(),o=n-t,l=Math.floor(o/864e5),i=Math.floor(o%864e5/36e5),r=Math.floor(o%36e5/6e4),c=Math.floor(o%6e4/1e3);document.getElementById(e).innerHTML="Còn "+l+" ngày "+i+":"+r+":"+c,o<0&&(clearInterval(a),document.getElementById(e).innerHTML="EXPIRED")},1e3)}function togglesc(){$(document).ready(function(){$("button").click(function(){$("p").toggle()})})}function updateTimerSlide(t,e){var n=new Date(t).getTime(),a=setInterval(function(){var t=(new Date).getTime(),o=n-t,l=Math.floor(o/864e5),i=Math.floor(o%864e5/36e5),r=Math.floor(o%36e5/6e4),c=Math.floor(o%6e4/1e3);document.getElementsByClassName(e)[0].innerHTML="Còn "+l+" ngày "+i+":"+r+":"+c,o<0&&(clearInterval(a),document.getElementsByClassName(e)[0].innerHTML="EXPIRED")},1e3)}function _FORMAT_MONEY(t){return(t/1).toFixed(0).replace(".",",").toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")+" ₫"}